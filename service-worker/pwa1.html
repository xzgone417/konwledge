<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    > ğŸ”” Generate by **https://chat.tinycms.xyz:3002/**
    ------
    <!-- å®ç°åœ¨å¦ä¸€ä¸ªé¡µé¢ç‚¹å‡»æŒ‰é’®å°†å·²ç»ä½¿ç”¨PWAçš„å…¶ä»–ç½‘é¡µæ·»åŠ åˆ°æ‰‹æœºæ¡Œé¢å¿«æ·æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥å®ç°ï¼š

    1. **ç¡®ä¿PWAæ”¯æŒ**ï¼šé¦–å…ˆç¡®ä¿ç›®æ ‡ç½‘é¡µå·²ç»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„PWAï¼ŒåŒ…æ‹¬æœ‰æ­£ç¡®é…ç½®çš„Web App Manifestå’ŒService Workerã€‚

    2. **è·¨é¡µé¢ä¼ é€’å®‰è£…äº‹ä»¶**ï¼šä¸ºäº†åœ¨å¦ä¸€ä¸ªé¡µé¢è§¦å‘PWAå®‰è£…è¿‡ç¨‹ï¼Œä½ éœ€è¦é€šè¿‡ä¸€äº›æ‰‹æ®µåœ¨é¡µé¢é—´ä¼ é€’å®‰è£…äº‹ä»¶æˆ–ä¿¡æ¯ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥å®ç°ï¼š

    - **åˆ©ç”¨å…±äº«çš„Service Worker**ï¼šå¦‚æœä¸¤ä¸ªé¡µé¢å…±äº«åŒä¸€ä¸ªService Workerï¼Œä½ å¯ä»¥åœ¨ç›®æ ‡é¡µé¢ä¸­æ³¨å†Œä¸€ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç­‰å¾…å®‰è£…äº‹ä»¶ã€‚

    - **ä½¿ç”¨PostMessage API**ï¼šåœ¨ç¬¬ä¸€ä¸ªé¡µé¢ï¼ˆå·²æœ‰PWAçš„é¡µé¢ï¼‰è®¾ç½®ä¸€ä¸ªç›‘å¬å™¨ï¼Œå½“æ¥æ”¶åˆ°ç‰¹å®šæ¶ˆæ¯æ—¶ï¼Œè§¦å‘PWAçš„å®‰è£…è¿‡ç¨‹ã€‚åœ¨ç¬¬äºŒä¸ªé¡µé¢ï¼ˆéœ€è¦å°†PWAæ·»åŠ åˆ°æ¡Œé¢çš„é¡µé¢ï¼‰é€šè¿‡PostMessageå‘é€è¿™ä¸ªæ¶ˆæ¯ã€‚

    - **é€šè¿‡Local Storageæˆ–IndexedDB**ï¼šåœ¨ç¬¬ä¸€ä¸ªé¡µé¢è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½ï¼Œè¡¨ç¤ºPWAå·²ç»å‡†å¤‡å¥½å®‰è£…ã€‚åœ¨ç¬¬äºŒä¸ªé¡µé¢ä¸­è½®è¯¢è¿™ä¸ªæ ‡å¿—ä½ï¼Œå½“æ£€æµ‹åˆ°æ—¶ï¼Œè§¦å‘å®‰è£…æ“ä½œã€‚

    3. **ç¤ºä¾‹ä»£ç æ¼”ç¤º**ï¼šä»¥ä¸‹æ˜¯ä¸€ä¸ªåŸºæœ¬çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ç¬¬ä¸€ä¸ªé¡µé¢ä¸­è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½ï¼Œå¹¶é€šè¿‡PostMessage APIåœ¨ç¬¬äºŒä¸ªé¡µé¢è§¦å‘PWAçš„å®‰è£…ï¼š

    åœ¨ç¬¬ä¸€ä¸ªé¡µé¢ï¼ˆå·²æœ‰PWAçš„é¡µé¢ï¼‰çš„JavaScriptä»£ç ï¼š -->

    ```javascript
    // è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½è¡¨ç¤ºPWAå·²å‡†å¤‡å¥½å®‰è£…
    localStorage.setItem('pwaReadyToInstall', 'true');
    ```

    åœ¨ç¬¬äºŒä¸ªé¡µé¢çš„JavaScriptä»£ç ä¸­ï¼Œå½“ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªç‰¹å®šæŒ‰é’®æ—¶è§¦å‘å®‰è£…æ“ä½œï¼š

    ```javascript
    // ç›‘å¬æ¥è‡ªå…¶ä»–é¡µé¢çš„æ¶ˆæ¯
    window.addEventListener('message', function(event) {
    // æ£€æŸ¥æ¶ˆæ¯æ¥æºå’Œå†…å®¹ï¼Œç¡®ä¿æ˜¯é¢„æœŸçš„å®‰è£…æ¶ˆæ¯
    if (event.origin !== 'https://example.com') return; // æ›¿æ¢æˆç¬¬ä¸€ä¸ªé¡µé¢çš„åŸŸå
    if (event.data === 'installPWA') {
    // è§¦å‘PWAçš„å®‰è£…è¿‡ç¨‹
    if (deferredPrompt) {
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then(function(choiceResult) {
    if (choiceResult.outcome === 'accepted') {
    console.log('User accepted the A2HS prompt');
    } else {
    console.log('User dismissed the A2HS prompt');
    }
    deferredPrompt = null;
    });
    }
    }
    });

    // å½“æŒ‰é’®è¢«ç‚¹å‡»æ—¶å‘é€æ¶ˆæ¯åˆ°ç¬¬ä¸€ä¸ªé¡µé¢
    document.getElementById('installButton').addEventListener('click', function() {
    // å‘é€æ¶ˆæ¯ç»™ç¬¬ä¸€ä¸ªé¡µé¢ï¼Œè§¦å‘PWAå®‰è£…
    window.opener.postMessage('installPWA', 'https://example.com'); // æ›¿æ¢æˆç¬¬ä¸€ä¸ªé¡µé¢çš„åŸŸå
    });
    ```

    åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œç¬¬ä¸€ä¸ªé¡µé¢é€šè¿‡è®¾ç½®LocalStorageä¸­çš„æ ‡å¿—ä½è¡¨ç¤ºPWAå·²å‡†å¤‡å¥½å®‰è£…ã€‚ç¬¬äºŒä¸ªé¡µé¢ç›‘å¬æ¥è‡ªç¬¬ä¸€ä¸ªé¡µé¢çš„æ¶ˆæ¯ï¼Œå½“æ¥æ”¶åˆ°æŒ‡å®šçš„æ¶ˆæ¯æ—¶ï¼Œè§¦å‘PWAçš„å®‰è£…è¿‡ç¨‹ã€‚

    é€šè¿‡è¿™ç§æ–¹æ³•ï¼Œä½ å¯ä»¥å®ç°åœ¨å¦ä¸€ä¸ªé¡µé¢ç‚¹å‡»æŒ‰é’®å°†å·²ç»ä½¿ç”¨PWAçš„å…¶ä»–ç½‘é¡µæ·»åŠ åˆ°æ‰‹æœºæ¡Œé¢å¿«æ·æ–¹å¼çš„åŠŸèƒ½ã€‚
</body>

</html>